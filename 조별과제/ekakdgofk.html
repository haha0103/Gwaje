<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ÏùºÏ†ïÌëú</title>
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f6fa;
    }
    h1 { text-align: center; margin: 20px 0; color: #2c3e50; }
    .calendar-container {
      width: 95%;
      max-width: 1100px;
      margin: 0 auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 20px;
    }
    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .calendar-header button {
      padding: 6px 12px;
      background: #3498db;
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .calendar-header button:hover { background: #2980b9; }
    table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    th, td {
      width: 14.28%;
      height: 90px;
      text-align: left;
      vertical-align: top;
      border: 1px solid #ecf0f1;
      padding: 5px;
      position: relative;
      cursor: pointer;
    }
    th { background: #ecf0f1; color: #2c3e50; text-align: center; }
    td.disabled { background: #f0f0f0; color: #bbb; cursor: default; }
    td.today { outline: 2px solid #3498db; background: #eaf6ff; }
    td.sunday { color: #e74c3c; }
    td.saturday { color: #2980b9; }
    td.holiday { color: #e74c3c; font-weight: bold; }

    .date-number { font-weight: bold; margin-bottom: 4px; }
    .events { display: flex; flex-direction: column; gap: 2px; }
    .event {
      padding: 2px 4px;
      border-radius: 4px;
      font-size: 12px;
      color: white;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    /* Î™®Îã¨ Í≥µÌÜµ */
    #modalBg, #categoryModalBg {
      display: none;
      position: fixed;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      justify-content: center;
      align-items: center;
      z-index: 10;
    }
    .modal-box {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      width: 320px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .modal-box h2 { margin-top: 0; }
    .modal-box input, .modal-box select {
      width: 100%;
      margin-bottom: 10px;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .modal-box button {
      padding: 8px 14px;
      margin-right: 5px;
      background: #3498db;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .modal-box button:hover { background: #2980b9; }

    /* ÏùºÏ†ï Î™©Î°ù */
    #eventList { margin-top: 30px; }
    .event-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 6px;
      background: #f8f9fa;
      margin-bottom: 8px;
      border-radius: 6px;
      font-size: 14px;
    }
    .event-item .title { flex: 1; font-weight: bold; }
    .event-item .date { color: #7f8c8d; }
    .btn-delete {
      background: #e74c3c;
      color: #fff;
      border: none;
      padding: 6px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-delete:hover { background: #c0392b; }

    /* Ìà¥ÌåÅ */
    #tooltip {
      position: absolute;
      background: #2c3e50;
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: 20;
    }
    .category-item {
      display:flex;
      justify-content:space-between;
      padding:4px 0;
      align-items:center;
    }

    body.dark-mode {
  background: #1e1e2f;
  color: #f0f0f0;
}

body.dark-mode h1 {
  color: #ffffff;
}

body.dark-mode .calendar-container {
  background: #2b2b3c;
  box-shadow: 0 2px 6px rgba(0,0,0,0.5);
}

body.dark-mode th {
  background: #3a3a4a;
  color: #f0f0f0;
}

body.dark-mode td {
  background: #2f2f40;
  color: #ddd;
  border-color: #444;
}

body.dark-mode td.disabled {
  background: #262636;
  color: #777;
}

body.dark-mode td.today {
  background: #34495e;
  outline: 2px solid #3498db;
}

body.dark-mode td.holiday {
  color: #ff6b6b;
}

body.dark-mode .event {
  color: #fff;
}

body.dark-mode .modal-box {
  background: #2e2e3f;
  color: #fff;
}

body.dark-mode input,
body.dark-mode select {
  background: #444;
  color: #fff;
  border: 1px solid #777;
}

body.dark-mode .btn-delete {
  background: #c0392b;
}

body.dark-mode .btn-delete:hover {
  background: #922b21;
}

body.dark-mode #tooltip {
  background: #555;
  color: #fff;
}

body.dark-mode .event-item {
  background: #3a3a4f;
  color: #eee;
}

  </style>
</head>
<body>
  <body>
    <!-- Ìôà Î≤ÑÌäº Ï∂îÍ∞Ä -->
    <a href="index.html" style="display: inline-flex; align-items: center; margin: 20px; text-decoration: none; font-weight: bold; color: #555;">
      <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#b4b4b4" viewBox="0 0 16 16" style="vertical-align: middle; margin-right: 5px;">
        <path fill-rule="evenodd" d="M8 3.293l6 6V13.5a1.5 1.5 0 0 1-1.5 1.5H11a.5.5 0 0 1-.5-.5V11a1 1 0 0 0-1-1H6.5a1 1 0 0 0-1 1v3a.5.5 0 0 1-.5.5H3.5A1.5 1.5 0 0 1 2 13.5V9.293l6-6z"/>
        <path fill-rule="evenodd" d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"/>
      </svg>
    </a>
  <h1>üìÖ ÌïôÏóÖ ÏùºÏ†ï Í¥ÄÎ¶¨ Îã¨Î†•</h1>
  <div class="calendar-container">
    <div class="calendar-header">
      <button id="prevMonthBtn">Ïù¥Ï†Ñ</button>
      <div id="monthYearLabel"></div>
      <div>
        <button id="categoryManageBtn">Ïπ¥ÌÖåÍ≥†Î¶¨ Í¥ÄÎ¶¨</button>
        <button id="toggleDarkModeBtn">üåô</button>
        <button id="nextMonthBtn">Îã§Ïùå</button>
      </div>
      
    </div>
    <table>
      <thead>
        <tr>
          <th>Ïùº</th><th>Ïõî</th><th>Ìôî</th><th>Ïàò</th>
          <th>Î™©</th><th>Í∏à</th><th>ÌÜ†</th>
        </tr>
      </thead>
      <tbody id="calendarBody"></tbody>
    </table>
    <div id="eventList"></div>
  </div>

  <!-- ÏùºÏ†ï Î™®Îã¨ -->
  <div id="modalBg">
    <div class="modal-box">
      <h2>ÏùºÏ†ï Ï∂îÍ∞Ä/Ìé∏Ïßë</h2>
      <form id="eventForm">
        <input type="text" id="eventTitle" placeholder="Ï†úÎ™©" required />
        <select id="eventCategory" required></select>
        <button type="submit">Ï†ÄÏû•</button>
        <button type="button" id="cancelBtn">Ï∑®ÏÜå</button>
      </form>
    </div>
  </div>

  <!-- Ïπ¥ÌÖåÍ≥†Î¶¨ Í¥ÄÎ¶¨ Î™®Îã¨ -->
  <div id="categoryModalBg">
    <div class="modal-box">
      <h2>Ïπ¥ÌÖåÍ≥†Î¶¨ Í¥ÄÎ¶¨</h2>
      <input type="text" id="newCategoryName" placeholder="Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶Ñ" />
      <input type="color" id="newCategoryColor" value="#27ae60" />
      <button id="addCategoryBtn">Ï∂îÍ∞Ä</button>
      <hr/>
      <div id="categoryList"></div>
      <button id="closeCategoryModal">Îã´Í∏∞</button>
    </div>
  </div>

  <div id="tooltip" aria-hidden="true"></div>

<script>
const calendarBody = document.getElementById('calendarBody');
const monthYearLabel = document.getElementById('monthYearLabel');
const prevMonthBtn = document.getElementById('prevMonthBtn');
const nextMonthBtn = document.getElementById('nextMonthBtn');
const modalBg = document.getElementById('modalBg');
const eventForm = document.getElementById('eventForm');
const eventTitleInput = document.getElementById('eventTitle');
const eventCategorySelect = document.getElementById('eventCategory');
const cancelBtn = document.getElementById('cancelBtn');
const eventList = document.getElementById('eventList');
const tooltip = document.getElementById('tooltip');

const categoryModalBg = document.getElementById('categoryModalBg');
const categoryListDiv = document.getElementById('categoryList');
const newCategoryName = document.getElementById('newCategoryName');
const newCategoryColor = document.getElementById('newCategoryColor');
const addCategoryBtn = document.getElementById('addCategoryBtn');
const categoryManageBtn = document.getElementById('categoryManageBtn');
const closeCategoryModal = document.getElementById('closeCategoryModal');

let currentDate = new Date();
let events = [];
let categories = {}; // {categoryKey:{name,color}}
let isEditing = false;
let editingIndex = null;
let selectedDateStr = '';

const koreanHolidays = ['2025-01-01','2025-03-01','2025-05-05','2025-06-06',
'2025-08-15','2025-10-03','2025-10-09','2025-12-25'];

function renderCategoryOptions(){
  eventCategorySelect.innerHTML = '<option value="">Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ†ÌÉù</option>';
  Object.keys(categories).forEach(key=>{
    const opt=document.createElement('option');
    opt.value=key;
    opt.textContent=categories[key].name;
    eventCategorySelect.appendChild(opt);
  });
}

function renderCategoryList(){
  categoryListDiv.innerHTML='';
  Object.keys(categories).forEach(key=>{
    const div=document.createElement('div');
    div.className='category-item';
    div.innerHTML=`<span style="color:${categories[key].color};font-weight:bold;">‚óè</span> ${categories[key].name}`;
    const del=document.createElement('button');
    del.textContent='ÏÇ≠Ï†ú';
    del.style.background='#e74c3c'; del.style.color='#fff'; del.style.border='none'; del.style.padding='2px 8px'; del.style.borderRadius='6px';
    del.onclick=()=>{
      delete categories[key];
      saveCategories();
      renderCategoryOptions();
      renderCategoryList();
      renderCalendar(currentDate.getFullYear(),currentDate.getMonth());
    };
    div.appendChild(del);
    categoryListDiv.appendChild(div);
  });
}

function renderCalendar(year, month) {
  calendarBody.innerHTML = '';
  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);
  const firstWeekday = firstDay.getDay();
  const daysInMonth = lastDay.getDate();
  monthYearLabel.textContent = `${year}ÎÖÑ ${month + 1}Ïõî`;
  let date = 1;
  for(let week=0; week<6; week++) {
    const tr = document.createElement('tr');
    for(let day=0; day<7; day++) {
      const td = document.createElement('td');
      if(week === 0 && day < firstWeekday || date > daysInMonth){
        td.classList.add('disabled');
        tr.appendChild(td);
        continue;
      }
      const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(date).padStart(2,'0')}`;
      if(day === 0) td.classList.add('sunday');
      if(day === 6) td.classList.add('saturday');
      if(koreanHolidays.includes(dateStr)) td.classList.add('holiday');

      const dateNumberDiv = document.createElement('div');
      dateNumberDiv.classList.add('date-number');
      dateNumberDiv.textContent = date;
      td.appendChild(dateNumberDiv);

      const today = new Date();
      if(date === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
        td.classList.add('today');
      }

      const eventsContainer = document.createElement('div');
      eventsContainer.classList.add('events');
      const dayEvents = events.filter(ev => ev.date === dateStr);
      dayEvents.forEach(ev => {
        const evDiv = document.createElement('div');
        evDiv.classList.add('event');
        if(categories[ev.category]){
          evDiv.style.background = categories[ev.category].color;
        }
        evDiv.textContent = ev.title;
        evDiv.addEventListener('mouseenter', e => {
          tooltip.textContent = ev.title;
          tooltip.style.opacity = '1';
          tooltip.style.left = e.pageX + 10 + 'px';
          tooltip.style.top = e.pageY + 10 + 'px';
          tooltip.setAttribute('aria-hidden', 'false');
        });
        evDiv.addEventListener('mouseleave', () => {
          tooltip.style.opacity = '0';
          tooltip.setAttribute('aria-hidden', 'true');
        });
        eventsContainer.appendChild(evDiv);
      });
      td.appendChild(eventsContainer);

      td.addEventListener('click', () => {
        if(td.classList.contains('disabled')) return;
        selectedDateStr = dateStr;
        isEditing = false;
        openModal();
      });
      tr.appendChild(td);
      date++;
    }
    calendarBody.appendChild(tr);
  }
}

function openModal(){
  if (!isEditing) eventForm.reset();
  renderCategoryOptions();
  modalBg.style.display='flex';
  eventTitleInput.focus();
}
function closeModal(){ modalBg.style.display='none'; }

function renderEventList(){
  if(events.length===0){ eventList.textContent='Îì±Î°ùÎêú ÏùºÏ†ïÏù¥ ÏóÜÏäµÎãàÎã§.'; return; }
  eventList.innerHTML='';
  events.sort((a,b)=>a.date.localeCompare(b.date));
  events.forEach((ev,idx)=>{
    const div=document.createElement('div');
    div.className='event-item';
    const colorDot=document.createElement('div');
    colorDot.className='event';
    colorDot.style.width='15px';
    colorDot.style.height='15px';
    colorDot.style.borderRadius='50%';
    colorDot.style.background=categories[ev.category]?.color || '#7f8c8d';

    const titleDiv=document.createElement('div');
    titleDiv.className='title';
    titleDiv.textContent=ev.title;

    const dateDiv=document.createElement('div');
    dateDiv.className='date';
    dateDiv.textContent=ev.date;

    const delBtn=document.createElement('button');
    delBtn.className='btn-delete';
    delBtn.textContent='ÏÇ≠Ï†ú';
    delBtn.addEventListener('click',()=>{
      events.splice(idx,1);
      saveEvents();
      renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
      renderEventList();
    });

    const editBtn=document.createElement('button');
    editBtn.textContent='Ìé∏Ïßë';
    editBtn.style.background='#2980b9';
    editBtn.style.color='white';
    editBtn.style.fontWeight='700';
    editBtn.style.padding='6px 14px';
    editBtn.style.borderRadius='8px';
    editBtn.style.cursor='pointer';
    editBtn.addEventListener('click',()=>{
      isEditing=true;
      editingIndex=idx;
      selectedDateStr=ev.date;
      eventTitleInput.value=ev.title;
      renderCategoryOptions();
      eventCategorySelect.value=ev.category;
      openModal();
    });

    div.append(colorDot,titleDiv,dateDiv,delBtn,editBtn);
    eventList.appendChild(div);
  });
}

function saveEvents(){ localStorage.setItem('events', JSON.stringify(events)); }
function loadEvents(){
  const data=localStorage.getItem('events');
  if(data) events=JSON.parse(data);
}
function saveCategories(){ localStorage.setItem('categories', JSON.stringify(categories)); }
function loadCategories(){
  const data=localStorage.getItem('categories');
  if(data) categories=JSON.parse(data);
  else {
    categories={
      assignment:{name:'Í≥ºÏ†ú',color:'#e67e22'},
      exam:{name:'ÏãúÌóò',color:'#e74c3c'},
      project:{name:'ÌîÑÎ°úÏ†ùÌä∏',color:'#27ae60'}
    };
  }
}

function init(){
  loadCategories();
  loadEvents();
  renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
  renderEventList();
}

prevMonthBtn.addEventListener('click',()=>{
  currentDate.setMonth(currentDate.getMonth()-1);
  renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
});
nextMonthBtn.addEventListener('click',()=>{
  currentDate.setMonth(currentDate.getMonth()+1);
  renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
});
cancelBtn.addEventListener('click',()=>{
  closeModal();
  isEditing=false;
  editingIndex=null;
});
modalBg.addEventListener('click',e=>{
  if(e.target===modalBg){ closeModal(); isEditing=false; editingIndex=null; }
});

eventForm.addEventListener('submit',e=>{
  e.preventDefault();
  const title=eventTitleInput.value.trim();
  const category=eventCategorySelect.value;
  if(!title || !category){ alert('Î™®Îì† Ìï≠Î™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.'); return; }
  if(isEditing && editingIndex!==null){
    events[editingIndex].title=title;
    events[editingIndex].category=category;
    events[editingIndex].date=selectedDateStr;
  } else {
    events.push({date:selectedDateStr,title,category});
  }
  saveEvents();
  renderCalendar(currentDate.getFullYear(), currentDate.getMonth());
  renderEventList();
  closeModal();
  isEditing=false;
  editingIndex=null;
});

// Ïπ¥ÌÖåÍ≥†Î¶¨ Í¥ÄÎ¶¨
categoryManageBtn.addEventListener('click',()=>{
  categoryModalBg.style.display='flex';
  newCategoryName.value='';
  renderCategoryList();
});
closeCategoryModal.addEventListener('click',()=>categoryModalBg.style.display='none');
categoryModalBg.addEventListener('click',e=>{ if(e.target===categoryModalBg) categoryModalBg.style.display='none'; });
addCategoryBtn.addEventListener('click',()=>{
  const name=newCategoryName.value.trim();
  const color=newCategoryColor.value;
  if(!name){ alert('Ïπ¥ÌÖåÍ≥†Î¶¨ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî'); return; }
  const key='cat_'+Date.now();
  categories[key]={name,color};
  saveCategories();
  renderCategoryOptions();
  renderCategoryList();
  newCategoryName.value='';
});

// Îã§ÌÅ¨ Î™®Îìú Ï†ÄÏû•/Î°úÎìú
function applyDarkMode(isDark) {
  document.body.classList.toggle('dark-mode', isDark);
  document.getElementById('toggleDarkModeBtn').textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
  localStorage.setItem('darkMode', isDark);
}

document.getElementById('toggleDarkModeBtn').addEventListener('click', () => {
  const isDark = !document.body.classList.contains('dark-mode');
  applyDarkMode(isDark);
});

// Ï¥àÍ∏∞Ìôî Ïãú Î°úÏª¨Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú Î™®Îìú Î∂àÎü¨Ïò§Í∏∞
const savedDarkMode = localStorage.getItem('darkMode') === 'true';
applyDarkMode(savedDarkMode);
init();
</script>
</body>
</html>
